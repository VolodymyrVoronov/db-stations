import{a as e}from"./rolldown-runtime-Cn8xt2Gj.js";import{a as t,i as n}from"./framer-motion-Jr-DK7GE.js";import"./tsparticles-Cc1rZ8r9.js";import{t as r}from"./jotai-BS2590Vw.js";import{a as i,c as a,d as o,f as s,h as c,i as l,m as u,o as d,p as f,s as p,t as m}from"./index-DK6-i-hY.js";import{t as h}from"./maplibre-gl-DA4pYVIA.js";var g=a(`locate`,[[`line`,{x1:`2`,x2:`5`,y1:`12`,y2:`12`,key:`bvdh0s`}],[`line`,{x1:`19`,x2:`22`,y1:`12`,y2:`12`,key:`1tbv5k`}],[`line`,{x1:`12`,x2:`12`,y1:`2`,y2:`5`,key:`11lu5j`}],[`line`,{x1:`12`,x2:`12`,y1:`19`,y2:`22`,key:`x3vr5v`}],[`circle`,{cx:`12`,cy:`12`,r:`7`,key:`fim9np`}]]),_=a(`maximize`,[[`path`,{d:`M8 3H5a2 2 0 0 0-2 2v3`,key:`1dcmit`}],[`path`,{d:`M21 8V5a2 2 0 0 0-2-2h-3`,key:`1e4gt3`}],[`path`,{d:`M3 16v3a2 2 0 0 0 2 2h3`,key:`wsl5sc`}],[`path`,{d:`M16 21h3a2 2 0 0 0 2-2v-3`,key:`18trek`}]]),v=a(`minus`,[[`path`,{d:`M5 12h14`,key:`1ays0h`}]]),y=a(`plus`,[[`path`,{d:`M5 12h14`,key:`1ays0h`}],[`path`,{d:`M12 5v14`,key:`s699le`}]]),b=a(`rotate-ccw`,[[`path`,{d:`M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8`,key:`1357e3`}],[`path`,{d:`M3 3v5h5`,key:`1xhq8a`}]]),x=u(),S=t(),C=(0,S.createContext)(null),w={didCatch:!1,error:null},T=class extends S.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=w}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(...e){let{error:t}=this.state;t!==null&&(this.props.onReset?.({args:e,reason:`imperative-api`}),this.setState(w))}componentDidCatch(e,t){this.props.onError?.(e,t)}componentDidUpdate(e,t){let{didCatch:n}=this.state,{resetKeys:r}=this.props;n&&t.error!==null&&E(e.resetKeys,r)&&(this.props.onReset?.({next:r,prev:e.resetKeys,reason:`keys`}),this.setState(w))}render(){let{children:e,fallbackRender:t,FallbackComponent:n,fallback:r}=this.props,{didCatch:i,error:a}=this.state,o=e;if(i){let e={error:a,resetErrorBoundary:this.resetErrorBoundary};if(typeof t==`function`)o=t(e);else if(n)o=(0,S.createElement)(n,e);else if(r!==void 0)o=r;else throw a}return(0,S.createElement)(C.Provider,{value:{didCatch:i,error:a,resetErrorBoundary:this.resetErrorBoundary}},o)}};function E(e=[],t=[]){return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}function D(e){return typeof e==`object`&&!!e&&`didCatch`in e&&typeof e.didCatch==`boolean`&&`error`in e&&`resetErrorBoundary`in e&&typeof e.resetErrorBoundary==`function`}function O(e){if(!D(e))throw Error(`ErrorBoundaryContext not found`)}function k(){let e=(0,S.useContext)(C);O(e);let{error:t,resetErrorBoundary:n}=e,[r,i]=(0,S.useState)({error:null,hasError:!1}),a=(0,S.useMemo)(()=>({error:t,resetBoundary:()=>{n(),i({error:null,hasError:!1})},showBoundary:e=>i({error:e,hasError:!0})}),[t,n]);if(r.hasError)throw r.error;return a}var A=e(h(),1),j=c(),M=n();function N(){return typeof document>`u`?null:document.documentElement.classList.contains(`dark`)?`dark`:document.documentElement.classList.contains(`light`)?`light`:null}function P(){return typeof window>`u`?`light`:window.matchMedia(`(prefers-color-scheme: dark)`).matches?`dark`:`light`}function F(e){let t=(0,x.c)(3),[n,r]=(0,S.useState)(I),i,a;return t[0]===e?(i=t[1],a=t[2]):(i=()=>{if(e)return;let t=new MutationObserver(()=>{let e=N();e&&r(e)});t.observe(document.documentElement,{attributes:!0,attributeFilter:[`class`]});let n=window.matchMedia(`(prefers-color-scheme: dark)`),i=e=>{N()||r(e.matches?`dark`:`light`)};return n.addEventListener(`change`,i),()=>{t.disconnect(),n.removeEventListener(`change`,i)}},a=[e],t[0]=e,t[1]=i,t[2]=a),(0,S.useEffect)(i,a),e??n}function I(){return N()??P()}var L=(0,S.createContext)(null);function R(){let e=(0,S.useContext)(L);if(!e)throw Error(`useMap must be used within a Map component`);return e}var z={dark:`https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json`,light:`https://basemaps.cartocdn.com/gl/positron-gl-style/style.json`},B=()=>{let e=(0,x.c)(1),t;return e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,M.jsx)(`div`,{className:`absolute inset-0 flex items-center justify-center`,children:(0,M.jsxs)(`div`,{className:`flex gap-1`,children:[(0,M.jsx)(`span`,{className:`bg-muted-foreground/60 size-1.5 animate-pulse rounded-full`}),(0,M.jsx)(`span`,{className:`bg-muted-foreground/60 size-1.5 animate-pulse rounded-full [animation-delay:150ms]`}),(0,M.jsx)(`span`,{className:`bg-muted-foreground/60 size-1.5 animate-pulse rounded-full [animation-delay:300ms]`})]})}),e[0]=t):t=e[0],t},V=(0,S.forwardRef)(function({children:e,theme:t,styles:n,projection:r,...i},a){let o=(0,S.useRef)(null),[s,c]=(0,S.useState)(null),[l,u]=(0,S.useState)(!1),[d,f]=(0,S.useState)(!1),p=(0,S.useRef)(null),m=(0,S.useRef)(null),h=F(t),g=(0,S.useMemo)(()=>({dark:n?.dark??z.dark,light:n?.light??z.light}),[n]);(0,S.useImperativeHandle)(a,()=>s,[s]);let _=(0,S.useCallback)(()=>{m.current&&=(clearTimeout(m.current),null)},[]);(0,S.useEffect)(()=>{if(!o.current)return;let e=h===`dark`?g.dark:g.light;p.current=e;let t=new A.default.Map({container:o.current,style:e,renderWorldCopies:!1,attributionControl:{compact:!0},...i}),n=()=>{_(),m.current=setTimeout(()=>{f(!0),r&&t.setProjection(r)},100)},a=()=>u(!0);return t.on(`load`,a),t.on(`styledata`,n),c(t),()=>{_(),t.off(`load`,a),t.off(`styledata`,n),t.remove(),u(!1),f(!1),c(null)}},[]),(0,S.useEffect)(()=>{if(!s||!h)return;let e=h===`dark`?g.dark:g.light;p.current!==e&&(_(),p.current=e,f(!1),s.setStyle(e,{diff:!0}))},[s,h,g,_]);let v=(0,S.useMemo)(()=>({map:s,isLoaded:l&&d}),[s,l,d]);return(0,M.jsx)(L.Provider,{value:v,children:(0,M.jsxs)(`div`,{ref:o,className:`relative h-full w-full`,children:[!l&&(0,M.jsx)(B,{}),s&&e]})})}),H=(0,S.createContext)(null);function U(){let e=(0,S.useContext)(H);if(!e)throw Error(`Marker components must be used within MapMarker`);return e}function W({longitude:e,latitude:t,children:n,onClick:r,onMouseEnter:i,onMouseLeave:a,onDragStart:o,onDrag:s,onDragEnd:c,draggable:l=!1,...u}){let{map:d}=R(),f=(0,S.useMemo)(()=>{let n=new A.default.Marker({...u,element:document.createElement(`div`),draggable:l}).setLngLat([e,t]);return n.getElement()?.addEventListener(`click`,e=>r?.(e)),n.getElement()?.addEventListener(`mouseenter`,e=>i?.(e)),n.getElement()?.addEventListener(`mouseleave`,e=>a?.(e)),n.on(`dragstart`,()=>{let e=n.getLngLat();o?.({lng:e.lng,lat:e.lat})}),n.on(`drag`,()=>{let e=n.getLngLat();s?.({lng:e.lng,lat:e.lat})}),n.on(`dragend`,()=>{let e=n.getLngLat();c?.({lng:e.lng,lat:e.lat})}),n},[]);(0,S.useEffect)(()=>{if(d)return f.addTo(d),()=>{f.remove()}},[d]),(f.getLngLat().lng!==e||f.getLngLat().lat!==t)&&f.setLngLat([e,t]),f.isDraggable()!==l&&f.setDraggable(l);let p=f.getOffset(),m=u.offset??[0,0],[h,g]=Array.isArray(m)?m:[m.x,m.y];return(p.x!==h||p.y!==g)&&f.setOffset(m),f.getRotation()!==u.rotation&&f.setRotation(u.rotation??0),f.getRotationAlignment()!==u.rotationAlignment&&f.setRotationAlignment(u.rotationAlignment??`auto`),f.getPitchAlignment()!==u.pitchAlignment&&f.setPitchAlignment(u.pitchAlignment??`auto`),(0,M.jsx)(H.Provider,{value:{marker:f,map:d},children:n})}function G(e){let t=(0,x.c)(10),{children:n,className:r}=e,{marker:i}=U(),a;t[0]===r?a=t[1]:(a=s(`relative cursor-pointer`,r),t[0]=r,t[1]=a);let o;t[2]===n?o=t[3]:(o=n||(0,M.jsx)(K,{}),t[2]=n,t[3]=o);let c;t[4]!==a||t[5]!==o?(c=(0,M.jsx)(`div`,{className:a,children:o}),t[4]=a,t[5]=o,t[6]=c):c=t[6];let l;return t[7]!==i||t[8]!==c?(l=(0,j.createPortal)(c,i.getElement()),t[7]=i,t[8]=c,t[9]=l):l=t[9],l}function K(){let e=(0,x.c)(1),t;return e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,M.jsx)(`div`,{className:`relative h-4 w-4 rounded-full border-2 border-white bg-blue-500 shadow-lg`}),e[0]=t):t=e[0],t}function q({children:e,className:t,closeButton:n=!1,...r}){let{marker:a,map:o}=U(),c=(0,S.useMemo)(()=>document.createElement(`div`),[]),l=(0,S.useRef)(r),u=(0,S.useMemo)(()=>new A.default.Popup({offset:16,...r,closeButton:!1}).setMaxWidth(`none`).setDOMContent(c),[]);if((0,S.useEffect)(()=>{if(o)return u.setDOMContent(c),a.setPopup(u),()=>{a.setPopup(null)}},[o]),u.isOpen()){let e=l.current;e.offset!==r.offset&&u.setOffset(r.offset??16),e.maxWidth!==r.maxWidth&&r.maxWidth&&u.setMaxWidth(r.maxWidth??`none`),l.current=r}return(0,j.createPortal)((0,M.jsxs)(`div`,{className:s(`bg-popover text-popover-foreground animate-in fade-in-0 zoom-in-95 relative rounded-md border p-3 shadow-md`,t),children:[n&&(0,M.jsxs)(`button`,{type:`button`,onClick:()=>u.remove(),className:`ring-offset-background focus:ring-ring absolute top-1 right-1 z-10 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-none`,"aria-label":`Close popup`,children:[(0,M.jsx)(i,{className:`h-4 w-4`}),(0,M.jsx)(`span`,{className:`sr-only`,children:`Close`})]}),e]}),c)}var J={"top-left":`top-2 left-2`,"top-right":`top-2 right-2`,"bottom-left":`bottom-2 left-2`,"bottom-right":`bottom-10 right-2`};function Y(e){let t=(0,x.c)(2),{children:n}=e,r;return t[0]===n?r=t[1]:(r=(0,M.jsx)(`div`,{className:`border-border bg-background [&>button:not(:last-child)]:border-border flex flex-col overflow-hidden rounded-md border shadow-sm [&>button:not(:last-child)]:border-b`,children:n}),t[0]=n,t[1]=r),r}function X(e){let t=(0,x.c)(8),{onClick:n,label:r,children:i,disabled:a}=e,o=a===void 0?!1:a,c=o&&`pointer-events-none cursor-not-allowed opacity-50`,l;t[0]===c?l=t[1]:(l=s(`hover:bg-accent dark:hover:bg-accent/40 flex size-8 items-center justify-center transition-colors`,c),t[0]=c,t[1]=l);let u;return t[2]!==i||t[3]!==o||t[4]!==r||t[5]!==n||t[6]!==l?(u=(0,M.jsx)(`button`,{onClick:n,"aria-label":r,type:`button`,className:l,disabled:o,children:i}),t[2]=i,t[3]=o,t[4]=r,t[5]=n,t[6]=l,t[7]=u):u=t[7],u}function Z(e){let t=(0,x.c)(34),{position:n,showZoom:r,showCompass:i,showLocate:a,showFullscreen:o,className:c,onLocate:l}=e,u=n===void 0?`bottom-right`:n,d=r===void 0?!0:r,f=i===void 0?!1:i,m=a===void 0?!1:a,h=o===void 0?!1:o,{map:b}=R(),[C,w]=(0,S.useState)(!1),T;t[0]===b?T=t[1]:(T=()=>{b?.zoomTo(b.getZoom()+1,{duration:300})},t[0]=b,t[1]=T);let E=T,D;t[2]===b?D=t[3]:(D=()=>{b?.zoomTo(b.getZoom()-1,{duration:300})},t[2]=b,t[3]=D);let O=D,k;t[4]===b?k=t[5]:(k=()=>{b?.resetNorthPitch({duration:300})},t[4]=b,t[5]=k);let A=k,j;t[6]!==b||t[7]!==l?(j=()=>{w(!0),`geolocation`in navigator&&navigator.geolocation.getCurrentPosition(e=>{let t={longitude:e.coords.longitude,latitude:e.coords.latitude};b?.flyTo({center:[t.longitude,t.latitude],zoom:14,duration:1500}),l?.(t),w(!1)},e=>{console.error(`Error getting location:`,e),w(!1)})},t[6]=b,t[7]=l,t[8]=j):j=t[8];let N=j,P;t[9]===b?P=t[10]:(P=()=>{let e=b?.getContainer();e&&(document.fullscreenElement?document.exitFullscreen():e.requestFullscreen())},t[9]=b,t[10]=P);let F=P,I=J[u],L;t[11]!==c||t[12]!==I?(L=s(`absolute z-10 flex flex-col gap-1.5`,I,c),t[11]=c,t[12]=I,t[13]=L):L=t[13];let z;t[14]!==E||t[15]!==O||t[16]!==d?(z=d&&(0,M.jsxs)(Y,{children:[(0,M.jsx)(X,{onClick:E,label:`Zoom in`,children:(0,M.jsx)(y,{className:`size-4`})}),(0,M.jsx)(X,{onClick:O,label:`Zoom out`,children:(0,M.jsx)(v,{className:`size-4`})})]}),t[14]=E,t[15]=O,t[16]=d,t[17]=z):z=t[17];let B;t[18]!==A||t[19]!==f?(B=f&&(0,M.jsx)(Y,{children:(0,M.jsx)(ee,{onClick:A})}),t[18]=A,t[19]=f,t[20]=B):B=t[20];let V;t[21]!==N||t[22]!==m||t[23]!==C?(V=m&&(0,M.jsx)(Y,{children:(0,M.jsx)(X,{onClick:N,label:`Find my location`,disabled:C,children:C?(0,M.jsx)(p,{className:`size-4 animate-spin`}):(0,M.jsx)(g,{className:`size-4`})})}),t[21]=N,t[22]=m,t[23]=C,t[24]=V):V=t[24];let H;t[25]!==F||t[26]!==h?(H=h&&(0,M.jsx)(Y,{children:(0,M.jsx)(X,{onClick:F,label:`Toggle fullscreen`,children:(0,M.jsx)(_,{className:`size-4`})})}),t[25]=F,t[26]=h,t[27]=H):H=t[27];let U;return t[28]!==L||t[29]!==z||t[30]!==B||t[31]!==V||t[32]!==H?(U=(0,M.jsxs)(`div`,{className:L,children:[z,B,V,H]}),t[28]=L,t[29]=z,t[30]=B,t[31]=V,t[32]=H,t[33]=U):U=t[33],U}function ee(e){let t=(0,x.c)(6),{onClick:n}=e,{map:r}=R(),i=(0,S.useRef)(null),a,o;t[0]===r?(a=t[1],o=t[2]):(a=()=>{if(!r||!i.current)return;let e=i.current,t=()=>{let t=r.getBearing(),n=r.getPitch();e.style.transform=`rotateX(${n}deg) rotateZ(${-t}deg)`};return r.on(`rotate`,t),r.on(`pitch`,t),t(),()=>{r.off(`rotate`,t),r.off(`pitch`,t)}},o=[r],t[0]=r,t[1]=a,t[2]=o),(0,S.useEffect)(a,o);let s;t[3]===Symbol.for(`react.memo_cache_sentinel`)?(s=(0,M.jsxs)(`svg`,{ref:i,viewBox:`0 0 24 24`,className:`size-5 transition-transform duration-200`,style:{transformStyle:`preserve-3d`},children:[(0,M.jsx)(`path`,{d:`M12 2L16 12H12V2Z`,className:`fill-red-500`}),(0,M.jsx)(`path`,{d:`M12 2L8 12H12V2Z`,className:`fill-red-300`}),(0,M.jsx)(`path`,{d:`M12 22L16 12H12V22Z`,className:`fill-muted-foreground/60`}),(0,M.jsx)(`path`,{d:`M12 22L8 12H12V22Z`,className:`fill-muted-foreground/30`})]}),t[3]=s):s=t[3];let c;return t[4]===n?c=t[5]:(c=(0,M.jsx)(X,{onClick:n,label:`Reset bearing to north`,children:s}),t[4]=n,t[5]=c),c}var te=u(),ne=()=>{let e=(0,te.c)(15),{t}=f(),{resetBoundary:n}=k(),r;e[0]===n?r=e[1]:(r=()=>{n()},e[0]=n,e[1]=r);let i=r,a;e[2]===t?a=e[3]:(a=t(`error.title`),e[2]=t,e[3]=a);let s;e[4]===a?s=e[5]:(s=(0,M.jsx)(`span`,{children:a}),e[4]=a,e[5]=s);let c;e[6]===t?c=e[7]:(c=t(`error.button`),e[6]=t,e[7]=c);let u;e[8]===Symbol.for(`react.memo_cache_sentinel`)?(u=(0,M.jsx)(b,{}),e[8]=u):u=e[8];let d;e[9]!==i||e[10]!==c?(d=(0,M.jsxs)(l,{onClick:i,variant:`secondary`,children:[c,` `,u]}),e[9]=i,e[10]=c,e[11]=d):d=e[11];let p;return e[12]!==s||e[13]!==d?(p=(0,M.jsx)(`div`,{children:(0,M.jsx)(o,{className:`relative h-[calc(100vh-74px)]`,children:(0,M.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[s,d]})})}),e[12]=s,e[13]=d,e[14]=p):p=e[14],p},re=u(),ie=e=>{let t=(0,re.c)(5),{coordinates:n,children:r}=e,{map:i,isLoaded:a}=R(),o,s;return t[0]!==n||t[1]!==a||t[2]!==i?(o=()=>{n&&(!a||!i||i.flyTo({center:n,zoom:15}))},s=[i,n,a],t[0]=n,t[1]=a,t[2]=i,t[3]=o,t[4]=s):(o=t[3],s=t[4]),(0,S.useEffect)(o,s),r},ae=u(),Q=51.1657,$=10.4515,oe=e=>{let t=(0,ae.c)(19),{stations:n}=e,i=r(m),a;t[0]!==i||t[1]!==n?(a=n?.find(e=>e.name===i),t[0]=i,t[1]=n,t[2]=a):a=t[2];let o=a,s;t[3]===o?.location?s=t[4]:(s=o?.location||{},t[3]=o?.location,t[4]=s);let{longitude:c,latitude:l}=s,u=c===void 0?$:c,f=l===void 0?Q:l,p;t[5]===Symbol.for(`react.memo_cache_sentinel`)?(p=(0,M.jsx)(ne,{}),t[5]=p):p=t[5];let h=o?.name,g;t[6]===h?g=t[7]:(g=[h],t[6]=h,t[7]=g);let _;t[8]===Symbol.for(`react.memo_cache_sentinel`)?(_=[$,Q],t[8]=_):_=t[8];let v;t[9]===Symbol.for(`react.memo_cache_sentinel`)?(v=(0,M.jsx)(Z,{showZoom:!0,showLocate:!0,showCompass:!0,showFullscreen:!0}),t[9]=v):v=t[9];let y;t[10]!==f||t[11]!==u||t[12]!==o?(y=o?(0,M.jsx)(ie,{coordinates:[u,f],children:(0,M.jsxs)(W,{longitude:u,latitude:f,children:[(0,M.jsx)(G,{children:(0,M.jsx)(d,{className:`text-red-600`})}),(0,M.jsx)(q,{closeButton:!0,className:`w-auto px-6`,children:(0,M.jsxs)(`div`,{className:`flex flex-col gap-1 text-center`,children:[(0,M.jsx)(`span`,{className:`text-sm font-semibold`,children:o?.name}),(0,M.jsxs)(`span`,{children:[o?.address?.zipcode,` `,o?.address?.city]}),(0,M.jsx)(`span`,{children:o?.address?.street}),(0,M.jsx)(`span`,{children:o?.federalState})]})})]})}):null,t[10]=f,t[11]=u,t[12]=o,t[13]=y):y=t[13];let b;t[14]===y?b=t[15]:(b=(0,M.jsxs)(V,{center:_,zoom:6,children:[v,y]}),t[14]=y,t[15]=b);let x;return t[16]!==b||t[17]!==g?(x=(0,M.jsx)(T,{fallback:p,resetKeys:g,children:b}),t[16]=b,t[17]=g,t[18]=x):x=t[18],x};export{oe as default};